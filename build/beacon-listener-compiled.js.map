{"version":3,"sources":["../src/js/beacon-listener.js"],"names":[],"mappings":"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","file":"beacon-listener-compiled.js","sourcesContent":["const TOP = 'top';\nconst RIGHT = 'right';\nconst BOTTOM = 'bottom';\nconst LEFT = 'left';\nconst EVENT_TYPE_BEACON_FOUND = 'beacon-listener:found';\nconst EVENT_TYPE_BEACON_LOST = 'beacon-listener:lost';\n/**\n *\n */\nclass BeaconListener {\n\n\tget events() {\n\t\treturn me._events;\n\t}\n\n\tget beacons(){\n\t\treturn me.getConfig('beacons');\n\t}\n\n\tset beacons(beacons){\n\t\tme._config.beacons = beacons;\n\t\tme._handleBeaconsChange();\n\t}\n\n\tconstructor( config ) {\n\n\t\tvar me = this,\n\t\t\tstaticClass = BeaconListener,\n\t\t\tbeacons,\n\t\t\tregion;\n\n\t\tconfig = config || {\n\t\t\t\tbeacons  : '.beacon',\n\t\t\t\tregion   : null,\n\t\t\t\tautoStart: false,\n\t\t\t\tpollInterval: 100\n\t\t\t};\n\t\tme._config = config;\n\t\tme._MIN_TIMER_VAL = 1;\n\n\t\tme._isListening = false;\n\t\tme._timerHandle = null;\n\t\tme._pollInterval = config.pollInterval;\n\t\tme._region = null;//a cache of the region for this listener\n\t\tme._beaconList = null;\n\t\tme._beaconStates = [];\n\t\tme._beaconDOMNodes = [];\n\t\tme._fullyInside = false;\n\t\tme.listeners = [];\n\n\n\t\tbeacons = config.beacons;\n\t\tregion = config.region;\n\n\t\t//LISTEN TO\n\t\tif ( beacons ) {\n\t\t\tme._handleBeaconsChange();\n\t\t}\n\n\t\t//REGION\n\t\tif ( region ) {\n\t\t\tme._handleRegionChange();\n\t\t}\n\n\t\tme._handleFullyInsideChange();//force setting of internal property\n\n\t\tif ( me.getConfig('autoStart') ) {\n\t\t\tme.start();\n\t\t\t//fire off a check now\n\n\t\t\tstaticClass.later(\n\t\t\t\tme.getConfig('pollInterval'),\n\t\t\t\tme,\n\t\t\t\tme.check,\n\t\t\t\tnull,\n\t\t\t\tfalse\n\t\t\t);\n\t\t}\n\n\t\twindow.addEventListener('scroll', () => me.check);\n\t\twindow.addEventListener('resize', () => me.check);\n\t\twindow.addEventListener('scroll', () => me._handleRegionChange);\n\t\twindow.addEventListener('resize', () => me._handleRegionChange);\n\t}\n\n\t/**\n\t * Stop listening for beacons\n\t *\n\t * @method stop\n\t *****************/\n\tstop() {\n\t\tvar me = this;\n\t\tif ( me._isListening === true && me._timerHandle !== null ) {\n\t\t\tme._timerHandle.cancel();\n\t\t\tme._timerHandle = null;\n\t\t\tme._isListening = false;\n\t\t}\n\t}\n\n\t/**\n\t * Start listening for beacons\n\t *\n\t * @method start\n\t *****************/\n\tstart() {\n\t\tvar me = this,\n\t\t\tstaticClass = BeaconListener;\n\t\tif (\n\t\t\tstaticClass.isUndefined(me._timerHandler)\n\t\t\t&& !staticClass.isUndefined(me._beaconList)\n\t\t\t&& me._beaconList !== null\n\t\t) {\n\t\t\tme._isListening = true;\n\t\t\t\n\t\t\tme._timerHandle = staticClass.later(\n\t\t\t\tme.getConfig('pollInterval'),\n\t\t\t\tme,\n\t\t\t\tme.check,\n\t\t\t\tnull,\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param node\n\t * @param fullyInside\n\t * @param altRegion\n\t * @returns {Boolean}\n\t */\n\tinViewportRegion( node, fullyInside, altRegion ) {\n\t\treturn this.inRegion(node, BeaconListener.viewportRegion(), fullyInside, altRegion)\n\t}\n\n\t/**\n\t *\n\t * @param node\n\t * @param node2\n\t * @param fullyInside\n\t * @param altRegion\n\t * @returns {Boolean}\n\t */\n\tinRegion( node, node2, fullyInside, altRegion ) {\n\t\tvar region = {},\n\t\t\tstaticClass = BeaconListener,\n\t\t\tr = altRegion || staticClass.getNodeRegion(node),\n\t\t\tn = node2,\n\t\t\toff;\n\n\t\tif ( n.tagName ) {\n\t\t\tregion = staticClass.getNodeRegion(n);\n\t\t} else if ( staticClass.isObject(node2) ) {\n\t\t\tregion = node2;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\n\t\tif ( fullyInside ) {\n\t\t\treturn (\n\t\t\tr[LEFT] >= region[LEFT] &&\n\t\t\tr[RIGHT] <= region[RIGHT] &&\n\t\t\tr[TOP] >= region[TOP] &&\n\t\t\tr[BOTTOM] <= region[BOTTOM]  );\n\t\t} else {\n\t\t\toff = staticClass.getOffsets(region, r);\n\t\t\treturn ( off[BOTTOM] >= off[TOP] && off[RIGHT] >= off[LEFT] );\n\t\t}\n\t}\n\n\tstatic getOffsets( r1, r2 ) {\n\t\tvar result = {};\n\n\t\tresult[TOP] = Math.max(r1[TOP], r2[TOP]);\n\t\tresult[RIGHT] = Math.min(r1[RIGHT], r2[RIGHT]);\n\t\tresult[BOTTOM] = Math.min(r1[BOTTOM], r2[BOTTOM]);\n\t\tresult[LEFT] = Math.max(r1[LEFT], r2[LEFT]);\n\t\treturn result;\n\t}\n\n\t/**\n\t * Check for beacons in the region\n\t *\n\t * @method check\n\t *****************/\n\tcheck() {\n\t\tvar me = this,\n\t\t\tregion = me._region,\n\t\t\ttestMethod;\n\n\t\tif ( region === null ) {\n\t\t\ttestMethod = me.inViewportRegion; //ex DOM\n\t\t} else {\n\t\t\tme._handleRegionChange();//since the scroll pos can change the region\n\t\t\tregion = me._region;\n\t\t\ttestMethod = me.inRegion;\n\t\t}\n\n\t\t[].forEach.call(me._beaconList, function ( node, index ) {\n\t\t\tvar testNode = me._beaconDOMNodes[index], inRegion, args;\n\n\t\t\tif ( region === null ) {\n\t\t\t\targs = [testNode, me._fullyInside];\n\t\t\t} else {\n\t\t\t\targs = [testNode, region, me._fullyInside];\n\t\t\t}\n\n\t\t\tinRegion = testMethod.apply(me, args);\n\n\t\t\tif ( inRegion && me._beaconStates[index] !== true ) {\n\t\t\t\t//if we encounter a beacon and it wasn't previously in the region\n\t\t\t\tme._beaconStates[index] = true;\n\n\t\t\t\tme.fireEvent(EVENT_TYPE_BEACON_FOUND, {listener: me, beacon: node}, me);\n\n\t\t\t} else if ( !inRegion && me._beaconStates[index] === true ) {\n\t\t\t\t//if we encounter a beacon and it was in the region\n\t\t\t\tme._beaconStates[index] = false;\n\n\t\t\t\tme.fireEvent(EVENT_TYPE_BEACON_LOST, {listener: me, beacon: node}, me);\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t *\n\t * @param type\n\t * @param data\n\t * @param dispatcher\n\t */\n\tfireEvent( type, data, dispatcher ) {\n\t\tdispatcher = dispatcher || document;\n\t\tvar event = new CustomEvent(type, {detail: data, target: this});\n\t\tdispatcher.dispatchEvent(event);\n\t}\n\n\taddEventListener ( type, callback ) {\n\t\tif ( !(type in this.listeners) ) {\n\t\t\tthis.listeners[type] = [];\n\t\t}\n\t\tthis.listeners[type].push(callback);\n\t}\n\n\tremoveEventListener ( type, callback ) {\n\t\tif ( !(type in this.listeners) ) {\n\t\t\treturn;\n\t\t}\n\t\tvar stack = this.listeners[type];\n\t\tfor ( var i = 0, l = stack.length; i < l; i++ ) {\n\t\t\tif ( stack[i] === callback ) {\n\t\t\t\tstack.splice(i, 1);\n\t\t\t\treturn this.removeEventListener(type, callback);\n\t\t\t}\n\t\t}\n\t}\n\n\tdispatchEvent( event ) {\n\t\tif ( !(event.type in this.listeners) ) {\n\t\t\treturn;\n\t\t}\n\t\tvar stack = this.listeners[event.type];\n\t\t//event.target = this;\n\t\tfor ( var i = 0, l = stack.length; i < l; i++ ) {\n\t\t\tstack[i].call(this, event);\n\t\t}\n\t\tdocument.dispatchEvent(event);\n\t}\n\n\t/**\n\t * a clone of YUI3 Y.later\n\t *\n\t * @param when\n\t * @param obj\n\t * @param fn\n\t * @param data\n\t * @param periodic\n\t * @returns {{id: number, interval: *, cancel: cancel}}\n\t */\n\tstatic later( when, obj, fn, data, periodic ) {\n\t\tvar emptyArray = [],\n\t\t\tstaticClass = BeaconListener;\n\n\t\twhen = when || 0;\n\n\t\tif ( !staticClass.isUndefined(data) && data ) {\n\t\t\tdata = (!staticClass.isUndefined(data)) ? (Array.isArray(data)) ? data : (data.hasOwnProperty(\"slice\")) ? Array.from(data) : emptyArray : emptyArray;\n\t\t} else {\n\t\t\tdata = emptyArray;\n\t\t}\n\n\t\tobj = obj || window;\n\n\t\tvar cancelled = false,\n\t\t\tmethod = (obj && staticClass.isString(fn)) ? obj[fn] : fn,\n\t\t\twrapper = function () {\n\t\t\t\t// IE 8- may execute a setInterval callback one last time\n\t\t\t\t// after clearInterval was called, so in order to preserve\n\t\t\t\t// the cancel() === no more runny-run, we have to jump through\n\t\t\t\t// an extra hoop.\n\t\t\t\tif ( !cancelled ) {\n\t\t\t\t\tif ( !method.apply ) {\n\t\t\t\t\t\tmethod(data[0], data[1], data[2], data[3]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmethod.apply(obj, data || emptyArray);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tid = (periodic) ? setInterval(wrapper, when) : setTimeout(wrapper, when);\n\n\t\treturn {\n\t\t\tid      : id,\n\t\t\tinterval: periodic,\n\t\t\tcancel  : function () {\n\t\t\t\tcancelled = true;\n\t\t\t\tif ( this.interval ) {\n\t\t\t\t\tclearInterval(id);\n\t\t\t\t} else {\n\t\t\t\t\tclearTimeout(id);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\t/**\n\t * test if a variable is undefined\n\t *\n\t * @param value\n\t * @returns {boolean}\n\t */\n\tstatic isUndefined( value ) {\n\t\treturn typeof value === 'undefined';\n\t}\n\n\t/**\n\t * test if a variable is a string\n\t * @param value\n\t * @returns {boolean}\n\t */\n\tstatic isString( value ) {\n\t\treturn typeof value === 'string';\n\t}\n\n\t/**\n\t *\n\t * @param obj\n\t * @returns {*|boolean}\n\t */\n\tstatic isObject( obj ) {\n\t\tvar varType = typeof obj,\n\t\t\tstaticClass = BeaconListener;\n\t\treturn (obj\n\t\t\t\t&& (\n\t\t\t\t\tvarType === 'object'\n\t\t\t\t\t|| (\n\t\t\t\t\t\tvarType === 'function'\n\t\t\t\t\t\t|| staticClass.isFunction(obj)\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t\t|| false;\n\t}\n\n\t/**\n\t *\n\t * @param o\n\t * @returns {boolean}\n\t */\n\tstatic isFunction( o ) {\n\t\treturn typeof o === 'function';\n\t}\n\n\t/**\n\t *\n\t * @param value\n\t * @returns {boolean}\n\t */\n\tstatic isNumber( value ) {\n\t\treturn typeof value === 'number' && isFinite(value);\n\t}\n\n\t/**\n\t *\n\t * @param node\n\t * @returns {boolean}\n\t */\n\tstatic getNodeXY( node ) {\n\n\t\tvar win = window,\n\t\t\twinXY,\n\t\t\tnodeXY = false,\n\t\t\tnodeRect;\n\n\t\tif ( node && win ) {\n\t\t\twinXY = [win.pageXOffset, win.pageYOffset];\n\t\t\tnodeRect = node.getBoundingClientRect();\n\t\t\tnodeXY = [winXY[0] + nodeRect.left, winXY[1] + nodeRect.top];\n\t\t}\n\t\treturn nodeXY;\n\t}\n\n\t/**\n\t * Get a setting from the config object\n\t *\n\t * @param configItem\n\t * @returns {*}\n\t */\n\tgetConfig( configItem ) {\n\t\tif ( this._config.hasOwnProperty(configItem) ) {\n\t\t\treturn this._config[configItem];\n\t\t}\n\t\treturn null\n\t}\n\n\t/**\n\t * Check if the listener is listening\n\t *\n\t * @method isListening\n\t **********************/\n\tisListening() {\n\t\treturn this._isListening;\n\t}\n\n\t/**\n\t * @private\n\t * @method _handleFullyInsideChange\n\t **********************/\n\t_handleFullyInsideChange() {\n\t\tvar me = this;\n\t\t//store the fullyInside property internally\n\t\tme._fullyInside = me.getConfig('fullyInside');\n\t}\n\n\t/**\n\t * @private\n\t * @method _handleRegionChange\n\t *****************/\n\t_handleRegionChange() {\n\t\tvar me = this,\n\t\t\tregion = me.getConfig('region');\n\n\t\twindow.requestAnimationFrame(function () {\n\t\t\tme.recalcRegion(region);\n\t\t});\n\t}\n\n\t/**\n\t * @protected\n\t * @method _handleBeaconsChange\n\t *****************/\n\t_handleBeaconsChange() {\n\t\tvar me = this,\n\t\t\tstaticClass = BeaconListener,\n\t\t\tbeacons = me.getConfig('beacons');\n\n\t\tme._beaconDOMNodes = [];\n\t\tme._beaconList = staticClass._getList(beacons);\n\t\tme._beaconStates = [].fill(false, me._beaconList.length);\n\n\t\tif ( me._beaconList && me._beaconList.length > 0 ) {\n\t\t\t[].forEach.call(me._beaconList, function ( node, index ) {\n\t\t\t\tme._beaconStates[index] = false;\n\t\t\t\tme._beaconDOMNodes[index] = node;\n\t\t\t});\n\t\t}\n\n\t}\n\n\t/**\n\t *\n\t * @param val\n\t * @returns {NodeList}\n\t * @private\n\t */\n\tstatic _getList( val ) {\n\t\treturn document.querySelectorAll(val);\n\t}\n\n\n\t/**\n\t *\n\t * Recalculate the region\n\t * The the region is a valid object then the current region will be overwritten\n\t *\n\t * @param region (optional)\n\t * @method recalcRegion\n\t */\n\trecalcRegion( region ) {\n\t\tvar me = this,\n\t\t\tnewRegion,\n\t\t\tstaticClass = BeaconListener;\n\n\t\tif ( staticClass.isUndefined(region) ) {\n\t\t\tregion = me._region;\n\t\t}\n\n\t\tif ( staticClass.isObject(region) && (\n\t\t\t\tstaticClass.isNumber(region[TOP])\n\t\t\t\t&& staticClass.isNumber(region[RIGHT])\n\t\t\t\t&& staticClass.isNumber(region[BOTTOM])\n\t\t\t\t&& staticClass.isNumber(region[LEFT])\n\t\t\t) ) {\n\t\t\tme._region = region;\n\t\t\treturn;\n\t\t} else {\n\t\t\tregion = document.querySelector(region);\n\n\t\t\tif ( region ) {\n\t\t\t\tnewRegion = staticClass.getNodeRegion(region);\n\n\t\t\t\tif ( newRegion ) {\n\t\t\t\t\tme._region = newRegion;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//default to the viewport\n\t\tme._region = null;\n\t}\n\n\t/**\n\t *\n\t * @param node\n\t * @returns {boolean}\n\t */\n\tstatic viewportRegion( node ) {\n\t\tnode = node || document.body.parentNode;\n\t\tvar result = false,\n\t\t\tscrollX,\n\t\t\tscrollY,\n\t\t\tstaticClass = BeaconListener;\n\n\t\tif ( node ) {\n\t\t\tscrollX = node.offsetLeft;\n\t\t\tscrollY = node.offsetTop;\n\n\t\t\tresult = staticClass._getRegion(scrollY, // top\n\t\t\t\tstaticClass.winWidth(node) + scrollX, // right\n\t\t\t\tscrollY + staticClass.winHeight(node), // bottom\n\t\t\t\tscrollX); // left\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t/**\n\t *\n\t * @param top\n\t * @param right\n\t * @param bottom\n\t * @param left\n\t * @returns {{}}\n\t * @private\n\t */\n\tstatic _getRegion( top, right, bottom, left ) {\n\n\t\tvar region = {};\n\n\t\tregion[TOP] = region[1] = top;\n\t\tregion[LEFT] = region[0] = left;\n\t\tregion[BOTTOM] = bottom;\n\t\tregion[RIGHT] = right;\n\t\tregion.width = region[RIGHT] - region[LEFT];\n\t\tregion.height = region[BOTTOM] - region[TOP];\n\n\t\treturn region;\n\n\t}\n\n\n\t/**\n\t *\n\t * @param node\n\t */\n\tstatic getNodeRegion( node ) {\n\t\tvar rect,\n\t\t\tresult = false;\n\n\t\tif ( node ) {\n\t\t\trect = node.getBoundingClientRect();\n\t\t\treturn BeaconListener._getRegion(rect.top, rect.right, rect.bottom, rect.left);\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic _getWinSize( node, doc ) {\n\t\tdoc = doc || document;\n\t\tvar win = doc.defaultView || doc.parentWindow,\n\t\t\tmode = doc.compatMode,\n\t\t\th = win.innerHeight,\n\t\t\tw = win.innerWidth,\n\t\t\troot = doc.documentElement;\n\n\t\tif ( mode ) {\n\t\t\tif ( mode != 'CSS1Compat' ) { // Quirks\n\t\t\t\troot = doc.body;\n\t\t\t}\n\t\t\th = root.clientHeight;\n\t\t\tw = root.clientWidth;\n\t\t}\n\t\treturn {height: h, width: w};\n\t}\n\n\n\t/**\n\t * Returns the inner height of the viewport (exludes scrollbar).\n\t * @method winHeight\n\t * @return {Number} The current height of the viewport.\n\t */\n\tstatic winHeight( node ) {\n\t\treturn BeaconListener._getWinSize(node).height;\n\t}\n\n\t/**\n\t * Returns the inner width of the viewport (exludes scrollbar).\n\t * @method winWidth\n\t * @return {Number} The current width of the viewport.\n\t */\n\tstatic winWidth( node ) {\n\t\treturn BeaconListener._getWinSize(node).width;\n\t}\n\n\t/**\n\t * Document height\n\t * @method docHeight\n\t * @return {Number} The current height of the document.\n\t */\n\tstatic docHeight( node ) {\n\t\tvar staticClass = BeaconListener,\n\t\t\th = staticClass._getDocSize(node).height;\n\t\treturn Math.max(h, staticClass._getWinSize(node).height);\n\t}\n\n\t/**\n\t * Document width\n\t * @method docWidth\n\t * @return {Number} The current width of the document.\n\t */\n\tstatic docWidth( node ) {\n\t\tvar staticClass = BeaconListener,\n\t\t\tw = staticClass._getDocSize(node).width;\n\t\treturn Math.max(w, staticClass._getWinSize(node).width);\n\t}\n\n\t/**\n\t *\n\t * @returns {{height: number, width: number}}\n\t * @private\n\t */\n\tstatic _getDocSize() {\n\t\tvar doc = doc || document,\n\t\t\troot = doc.documentElement;\n\n\t\tif ( doc.compatMode != 'CSS1Compat' ) {\n\t\t\troot = doc.body;\n\t\t}\n\n\t\treturn {height: root.scrollHeight, width: root.scrollWidth};\n\t}\n\n\t/**\n\t * The amount page has been scroll horizontally\n\t *\n\t * @param doc\n\t * @returns {number} The current amount the screen is scrolled horizontally.\n\t */\n\tstatic docScrollX( doc ) {\n\t\tvar t;\n\t\tdoc = doc || document;\n\t\treturn (((t = doc.documentElement) || (t = doc.body.parentNode))\n\t\t&& typeof t.scrollLeft == 'number' ? t : doc.body).scrollLeft\n\t}\n\n\t/**\n\t * The amount the page has been scrolled vertically\n\t *\n\t * @param doc\n\t * @returns {number} The current amount the screen is scrolled vertically.\n\t */\n\tstatic docScrollY( doc ) {\n\t\tvar t;\n\t\tdoc = doc || document;\n\t\treturn (((t = doc.documentElement) || (t = doc.body.parentNode))\n\t\t&& typeof t.scrollTop == 'number' ? t : doc.body).scrollTop\n\t}\n\n}"]}